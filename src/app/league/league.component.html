<h2>順位計算設定</h2>
<form [formGroup]="calSettingForm">
    <div class="rate">
        <div>
            <div class="point-setting">
                <label>勝ち：</label>
                <input type="text" class="point-form" formControlName="win">点
                <br>
                <label>分け：</label>
                <input type="text" class="point-form" formControlName="draw">点
                <br>
                <label>負け：</label>
                <input type="text" class="point-form" formControlName="lose">点
            </div>
            <div class="winner-setting">
                <label>各グループの</label>
                <input type="text" class="winner-form" formControlName="winnerRanks">位までが勝ち上がる
            </div>
        </div>
        <div class="other-setting">
            <input type="checkbox" formControlName="isConsiderDifference">[1] 得失点差を考慮する
            <br>
            <input type="checkbox" formControlName="isConsiderTotalGains">[2] 総得点数を考慮する
            <br>
            <input type="checkbox" formControlName="isConsiderDirectMatch">[3] 直接対決の勝敗を考慮する
            <br>
        </div>
    </div>
    <div class="discription">
        <p>
            各プレイヤーの順位は「勝ち点数 > [1] 得失点差 > [2] 総得点数 > [3] 直接対決の勝敗」の順で決定されます。<br>
            [1]〜[3]の条件を考慮するかどうかはチェックボックスのON/OFFで任意に設定可能です。
        </p>
    </div>
    <button type="submit" (click)="updateLeagues()">結果を更新する</button>
</form>
<hr>
<h2>リーグ表</h2>
<div *ngIf="linkages">
    <div id="group-1" *ngFor="let group of groups">
        <h3 *ngIf="group">{{group.name}}</h3>
        <div class="match-list" *ngIf="matchInformations">
            <div *ngFor="let round of getRoundNumber(group.id); let i = index;">
                <p>------- 第{{i + 1}}回戦 -------</p>
                <div *ngFor="let matchInfo of getMatchInformationsOfEachGroups(group.id, i + 1)">
                    <table class="match-parts">
                        <tr>
                            <td class="match-player">{{matchInfo.match[0].name}}</td>
                            <td class="match-forms">
                                <div class="result">
                                    <button class="result-win"
                                        (click)="inputResult(matchInfo, score1.value, score2.value, 0, matchInfo.match)"
                                        [class.pushed-win]="isPushed(0, matchInfo.id)">
                                        ○
                                    </button>
                                    <button class="result-draw"
                                        (click)="inputResult(matchInfo, score1.value, score2.value, 2)"
                                        [class.pushed-draw]="isPushed(2, matchInfo.id)">
                                        △
                                    </button>
                                    <button class=" result-win"
                                        (click)="inputResult(matchInfo, score1.value, score2.value, 1, matchInfo.match)"
                                        [class.pushed-win]="isPushed(1, matchInfo.id)">
                                        ○
                                    </button>
                                </div>
                                <div class="score">
                                    <input type="text" class="score-form" value="{{matchInfo.score1}}"
                                        (blur)="inputResult(matchInfo, score1.value, score2.value, null, matchInfo.match)"
                                        #score1> -
                                    <input type="text" class="score-form" value="{{matchInfo.score2}}"
                                        (blur)="inputResult(matchInfo, score1.value, score2.value, null, matchInfo.match)"
                                        #score2>
                                </div>
                            </td>
                            <td class="match-player">{{matchInfo.match[1].name}}</td>
                        </tr>
                    </table>
                </div>
                <div class="match-break">
                    {{getBreakPlayerMessage(group.id, i + 1)}}
                </div>
            </div>
        </div>
        <div class="league">
            <table border=1 *ngIf="matchInformations">
                <tr>
                    <td></td>
                    <td *ngFor="let player of getPlayersOfEachGroups(group.id)">
                        {{player.name}}
                    </td>
                    <td>勝点</td>
                    <td>得点</td>
                    <td>失点</td>
                    <td>得失点差</td>
                    <td>順位</td>
                </tr>
                <tr *ngFor="let player1 of getPlayersOfEachGroups(group.id)"
                    [class.superior]="isSuperiorOfFinalRound(group.id, player1.isSuperior)">
                    <td>
                        {{player1.name}}<mat-icon class="info">info</mat-icon>
                    </td>
                    <td class="result-cell" *ngFor="let player2 of getPlayersOfEachGroups(group.id)">
                        {{getMatchResultSymbol(group.id, player1.id, player2.id)}}
                    </td>
                    <td>{{player1.points}}</td>
                    <td>{{player1.gains}}</td>
                    <td>{{player1.losts}}</td>
                    <td>{{player1.gains - player1.losts}}</td>
                    <td>{{player1.rank}}</td>
                </tr>
            </table>
        </div>
    </div>
</div>